<main>
  <dl class="md:flex md:justify-between">
    <!-- WPM -->
    <div>
      <dt>WPM:</dt>
      <dd>0</dd>
    </div>

    <!-- Accuracy -->
    <div>
      <dt>Accuracy:</dt>
      <dd>0%</dd>
    </div>

    <!-- Time -->
    <div>
      <dt>Time:</dt>
      <dd>{{ time$ | async }}</dd>
    </div>
  </dl>

  <form class="md:flex md:justify-between mb-8" #settingsForm="ngForm">
    <fieldset class="md:flex md:justify-between">
      <legend>Difficulty:</legend>

      <label for="easy">Easy</label>
      <input type="radio" name="difficulty" id="easy" [(ngModel)]="difficulty" value="easy" />

      <label for="medium">Medium</label>
      <input type="radio" name="difficulty" id="medium" [(ngModel)]="difficulty" value="medium" />

      <label for="hard">Hard</label>
      <input type="radio" name="difficulty" id="hard" [(ngModel)]="difficulty" value="hard" />
    </fieldset>

    <fieldset>
      <legend>Mode:</legend>

      <label for="timed">Timed (60s)</label>
      <input type="radio" name="mode" id="timed" [(ngModel)]="mode" value="TIMED" />

      <label for="passage">Passage</label>
      <input type="radio" name="mode" id="passage" [(ngModel)]="mode" value="PASSAGE" />
    </fieldset>
  </form>

  <div class="relative min-h-80">
    <div>
      @for(char of testText$ | async; track $index; let i = $index) {
      <span
        [class]="{
          'text-gray-800': char.state === 'PENDING',
          'text-green-500': char.state === 'CORRECT',
          'text-red-500': char.state === 'INCORRECT'
        }"
        [class.bg-red-500]="(cursorPosition$ | async) === i"
        >{{ char.value }}</span
      >
      }
    </div>

    <div
      [class.grid]="!(testStarted$ | async)"
      [class.hidden]="testStarted$ | async"
      class="absolute inset-0 w-full grid place-items-center backdrop-blur-xs bg-amber-300/30"
    >
      <div class="text-center">
        <button class="start-button cursor-pointer" (click)="onStartChallenge()">Start Typing Test</button>
        <p>Or click the text and start typing</p>
      </div>
    </div>
  </div>

  <div
    [class.block]="testStarted$ | async"
    [class.hidden]="!(testStarted$ | async)"
    class="text-center"
  >
    <button class="cursor-pointer" (click)="onRestartChallenge()">Restart Test</button>
  </div>
</main>
